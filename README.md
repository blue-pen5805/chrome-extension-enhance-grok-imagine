# Grok Interaction Chrome Extension Template

このリポジトリは、grok.com 上の要素およびイベントタイミングに介入する Chrome 拡張機能のテンプレートです。以下の構成で簡単に拡張できます。

## 構成

- `manifest.json`: Chrome 拡張のメタデータと権限設定。`https://grok.com/*` のみに作用するようにホスト権限を限定しています。
- `src/background.js`: バックグラウンドでメッセージルーティングと初期化を行うサービスワーカー。
- `src/content/index.js`: Grok.com の DOM 要素とタイマー API をフックするコンテンツスクリプト。対象セレクターのクリックを横取りし、`setTimeout` / `setInterval` をラップしてタイミングデータを取得します。
- `ui/popup.html`: 拡張機能のアクションポップアップ。DOM 再スキャンや最近のイベントログの閲覧・クリア操作が可能です。
- `assets/` ディレクトリ: 各自で PNG アイコンを配置するためのフォルダー。テンプレートにはバイナリを含めない方針のため空になっています。

## 使い方

1. Chrome で `chrome://extensions` を開き、デベロッパーモードを ON にする。
2. 「パッケージ化されていない拡張機能を読み込む」でこのディレクトリを選択する。
3. Grok.com を開くと、テンプレートが自動で DOM を監視し、クリックやタイマーイベントを `chrome.runtime.sendMessage` 経由でバックグラウンドに送信します。
4. 拡張アイコンをクリックするとポップアップから DOM 再スキャンやイベントログの更新・削除が行えます。

### イベントログの活用

- バックグラウンドサービスワーカーは最新 50 件の介入イベントを保持し、ポップアップの「Refresh log」ボタンで取得できます。
- 「Clear log」で蓄積済みログを即座に削除でき、不要な履歴を残さず動作検証が可能です。
- ログにはイベント種別や対象セレクター、タイマー遅延が含まれるため、grok.com での介入状況をすばやく可視化できます。

## カスタマイズ例

- `TARGET_SELECTORS` に介入したい要素のセレクターを追加。
- `TimingInterceptor` 内で、必要な計測や抑制ロジックを追加。
- バックグラウンドで受信したメッセージを永続化・解析・外部 API に転送。
- ポップアップに設定 UI やログビューアを追加。

### アイコンの追加方法

バイナリファイルを含めた PR が作成できない環境を想定し、リポジトリからアイコン画像は除外しています。必要に応じて以下の手順で PNG を用意してください。

1. 任意の画像エディタで 16/48/128px の PNG を作成する。
2. `assets/icon16.png` などの名前で保存し、同ディレクトリに配置する。
3. 変更をローカルで保持したまま、PR に含めたくない場合は `.gitignore` などで除外する。

このテンプレートから、grok.com の挙動を制御・拡張する独自機能を構築してください。
